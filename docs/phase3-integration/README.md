# Phase 3: 統合シナリオと比較検証

## 概要

Phase 3では、実際のインシデント対応フローと他ツールとの比較を通じて、Wiz Codeの総合力を検証します。Phase 1、2で構築したシフトレフトとCode-to-Cloud追跡機能を統合し、実践的なユースケースで効果を実証します。

## 目的

1. **実践的な運用シナリオの検証**: Log4j等の重大な脆弱性発生時の対応フローを実証
2. **競合ツールとの比較**: AWS Inspectorとの定量的比較によりWizの優位性を明確化
3. **総合評価**: Phase 1、2の機能を統合した際の効果測定

## シナリオ一覧

### [S10: インシデント対応フロー](S10-incident-response.md)
Log4Shell等の重大な脆弱性が公開された際の、影響特定からコード修正、デプロイまでの一連の対応フローを実証します。

**検証項目**
- Wiz Threat Centerでの脆弱性確認
- 影響を受けるリソースの即座の特定
- Code-to-Cloud追跡によるソースコード特定
- 修正版のビルド・デプロイ・確認
- 対応時間の測定

### [S11: AWS Inspector vs Wiz比較](S11-aws-inspector-comparison.md)
同一のAWS ECS環境でAWS InspectorとWiz Codeを並行実行し、脆弱性検出能力、SBOM生成、Code-to-Cloud追跡能力を比較します。

**検証項目**
- 脆弱性検出数・精度の比較
- SBOM生成能力の比較
- Code-to-Cloud追跡能力の比較
- 優先順位付け機能の比較
- コスト・運用負荷の比較

## 成功基準

Phase 3のすべてのシナリオで以下が達成されること:

1. **S10: インシデント対応**
   - 影響範囲を5分以内に特定
   - ソースコードまで即座に追跡
   - 修正確認まで1時間以内に完了

2. **S11: 比較検証**
   - 定量的な比較データの取得
   - Wizの優位点が明確に示される
   - TIS提案資料に使用できる品質のデータ

## 実行順序

Phase 3のシナリオは以下の順序で実行します:

1. S10（インシデント対応）- 総合的な機能検証
2. S11（AWS Inspector比較）- 競合比較と差別化

## 前提条件

### Phase 1、2の完了
Phase 3は Phase 1、2の機能を統合するため、以下が完了していること:
- [Phase 1](../phase1-shift-left/README.md) の全シナリオ
- [Phase 2](../phase2-code-to-cloud/README.md) の全シナリオ

### AWS環境
- ECS/EKSクラスターが稼働中
- Wiz Sensor デプロイ済み
- 複数のワークロードがデプロイされている

### 比較検証用
- AWS Inspector有効化
- ECR Scanning有効化
- 両ツールでのスキャン完了

## インシデント対応フローの概要

```
1. 脆弱性の認知
   └→ Wiz Threat Center で新たなCVE検出
        ↓
2. 影響範囲の即座の特定
   └→ Wiz Security Graph で影響を受けるリソースをリスト化
        ↓
3. ソースコードの特定
   └→ Code-to-Cloud追跡でGitリポジトリ・コミットを特定
        ↓
4. コード修正
   └→ 依存関係を更新（package.json等）
        ↓
5. CI/CDでビルド・スキャン
   └→ GitHub Actionsで自動ビルド・Wizスキャン
        ↓
6. デプロイ
   └→ ECS/EKSに新バージョンをデプロイ
        ↓
7. 修正確認
   └→ Wiz Cloudで脆弱性が解消されたことを確認
```

## 比較検証のポイント

### AWS Inspector vs Wiz Code

| 評価項目 | AWS Inspector | Wiz Code | 差分 |
|---------|---------------|----------|------|
| **脆弱性検出** | | | |
| - コンテナイメージスキャン | ✅ | ✅ | - |
| - ソースコードスキャン | ❌ | ✅ | **Wizの優位** |
| - IaCスキャン | ❌ | ✅ | **Wizの優位** |
| **SBOM** | | | |
| - SBOM生成 | ✅ | ✅ | - |
| - フォーマット | CycloneDX | CycloneDX/SPDX | Wizが柔軟 |
| **追跡** | | | |
| - Code-to-Cloud | ❌ | ✅ | **Wizの優位** |
| - ソースコード特定 | ❌ | ✅ | **Wizの優位** |
| - CI/CD統合 | 限定的 | ✅ | **Wizの優位** |
| **優先順位付け** | | | |
| - ランタイムコンテキスト | ❌ | ✅ | **Wizの優位** |
| - 露出度分析 | 限定的 | ✅ | **Wizの優位** |
| **対応範囲** | | | |
| - マルチクラウド | ❌ AWSのみ | ✅ | **Wizの優位** |
| - 統合ダッシュボード | ❌ | ✅ | **Wizの優位** |

## データ収集方法

### 定量データ
- 脆弱性検出数（CRITICAL/HIGH/MEDIUM/LOW）
- False Positive率
- スキャン完了時間
- SBOM生成時間
- インシデント対応所要時間

### 定性データ
- ユーザビリティ評価
- ドキュメント品質
- サポート対応
- 学習曲線

## 期待される成果物

### S10: インシデント対応
1. **タイムライン記録**
   - 各ステップの所要時間
   - スクリーンショット
   - ログファイル

2. **比較レポート**
   - Wiz使用時 vs 従来の方法
   - 時間削減効果
   - 作業効率化

### S11: 比較検証
1. **定量比較レポート**
   - Excel/CSVでの数値データ
   - グラフ・チャート
   - 統計分析

2. **推奨事項**
   - Wizを選択すべき理由
   - ROI試算
   - 導入ロードマップ

## 検証環境の要件

### 共通インフラ
- 同一のAWS ECS環境を使用
- 同一のコンテナイメージを使用
- 公平な比較のため条件を統一

### モニタリング
- CloudWatch Logs
- X-Ray（オプション）
- カスタムメトリクス

## Phase終了後のアクション

Phase 3完了後:

1. **レポート作成**
   - 検証結果サマリー
   - 経営層向けプレゼンテーション
   - 技術詳細ドキュメント

2. **社内展開**
   - 開発チームへのトレーニング
   - セキュリティチームへの知識移転
   - 運用手順書の作成

3. **顧客提案**
   - デモシナリオの整備
   - PoC提案書の作成
   - 価格見積もりテンプレート

## 参考資料

- [Wiz Threat Center](https://docs.wiz.io/wiz-docs/docs/threat-center)
- [AWS Inspector](https://docs.aws.amazon.com/inspector/)
- [Log4Shell対応ガイド](https://www.cisa.gov/log4j)
- [SBOM比較ガイド](https://www.ntia.gov/SBOM)
