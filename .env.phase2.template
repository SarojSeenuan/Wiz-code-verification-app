# =============================================================================
# Phase 2: Code-to-Cloud トレーサビリティ検証用 環境変数テンプレート
# =============================================================================
# 対象シナリオ: S06-S09（Phase 1の環境変数も含む）
# 所要時間: 15-20時間（AWS環境必要）
#
# セットアップ手順:
# 1. Phase 1を先に完了すること（.env.phase1の設定が完了済み）
# 2. このファイルを .env.phase2 にコピー
# 3. 各環境変数に実際の値を設定
# 4. AWS環境をデプロイ: docs/guides/AWS_DEPLOYMENT_GUIDE.md 参照
# 5. Phase 2シナリオ（S06-S09）を実施
#
# 詳細: docs/guides/ENVIRONMENT_VARIABLES_GUIDE.md を参照
# =============================================================================

# -----------------------------------------------------------------------------
# 1. Wiz 認証情報（必須、Phase 1と同じ）
# -----------------------------------------------------------------------------
WIZ_CLIENT_ID=your_wiz_client_id_here
WIZ_CLIENT_SECRET=your_wiz_client_secret_here


# -----------------------------------------------------------------------------
# 2. GitHub 認証情報（必須、Phase 1と同じ）
# -----------------------------------------------------------------------------
GITHUB_TOKEN=your_github_token_here
GITHUB_OWNER=your_github_username_or_org
GITHUB_REPO=WizCodeVerification
GITHUB_REPOSITORY=${GITHUB_OWNER}/${GITHUB_REPO}


# -----------------------------------------------------------------------------
# 3. AWS 認証情報（必須）
# -----------------------------------------------------------------------------
# 取得方法: docs/guides/MANUAL_SETUP_GUIDE.md の「AWS認証情報の取得」セクション参照
# AWS IAM > Users > Security credentials > Create access key

AWS_ACCOUNT_ID=your_aws_account_id
AWS_REGION=ap-northeast-1
AWS_ACCESS_KEY_ID=your_aws_access_key_id
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key

# セッショントークン（一時認証情報を使用する場合のみ）
# AWS_SESSION_TOKEN=your_session_token


# -----------------------------------------------------------------------------
# 4. AWS ECS/ECR 設定（必須）
# -----------------------------------------------------------------------------
# Terraform apply後に取得される値

# ECRリポジトリ名
ECR_BACKEND_REPO=taskflow-backend
ECR_FRONTEND_REPO=taskflow-frontend

# ECRレジストリURL（AWS_ACCOUNT_ID.dkr.ecr.AWS_REGION.amazonaws.com形式）
ECR_REGISTRY=${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com

# ECSクラスター名
ECS_CLUSTER_NAME=taskflow-dev-cluster

# ECSサービス名
ECS_SERVICE_BACKEND=taskflow-backend-service
ECS_SERVICE_FRONTEND=taskflow-frontend-service


# -----------------------------------------------------------------------------
# 5. AWS RDS 設定（Phase 2で使用）
# -----------------------------------------------------------------------------
# Terraform apply後に取得される値（terraform output db_endpoint参照）

# RDSエンドポイント（terraform outputから取得）
RDS_ENDPOINT=your_rds_endpoint_here
RDS_PORT=5432
RDS_DB_NAME=taskflow_prod
RDS_USERNAME=taskflow_admin
RDS_PASSWORD=your_secure_rds_password_here


# -----------------------------------------------------------------------------
# 6. AWS VPC/ネットワーク設定（参照用）
# -----------------------------------------------------------------------------
# Terraform apply後に取得される値（terraform output参照）

# VPC ID
VPC_ID=vpc-xxxxxxxxxxxxxxxxx

# パブリックサブネットID
PUBLIC_SUBNET_1=subnet-xxxxxxxxxxxxxxxxx
PUBLIC_SUBNET_2=subnet-yyyyyyyyyyyyyyyyy

# プライベートサブネットID
PRIVATE_SUBNET_1=subnet-zzzzzzzzzzzzzzzzz
PRIVATE_SUBNET_2=subnet-wwwwwwwwwwwwwwwww

# ALB DNS名（terraform outputから取得）
ALB_DNS_NAME=your_alb_dns_name_here


# -----------------------------------------------------------------------------
# 7. Terraform Backend設定（オプション）
# -----------------------------------------------------------------------------
# リモートステート管理を使用する場合

# S3バケット名（Terraformステート保存用）
# TF_STATE_BUCKET=wiz-verification-terraform-state
# TF_STATE_KEY=taskflow/dev/terraform.tfstate
# TF_STATE_REGION=ap-northeast-1

# DynamoDBテーブル（ステートロック用）
# TF_STATE_LOCK_TABLE=wiz-verification-terraform-locks


# -----------------------------------------------------------------------------
# 8. Docker イメージビルド設定（S06, S07で使用）
# -----------------------------------------------------------------------------

# イメージタグ（通常はGitコミットSHAを使用）
# IMAGE_TAG=${GITHUB_SHA:-latest}

# ビルド日時（自動設定）
# BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')

# Gitコミット情報（GitHub Actionsで自動設定）
# GIT_COMMIT=${GITHUB_SHA}
# GIT_BRANCH=${GITHUB_REF_NAME}


# -----------------------------------------------------------------------------
# 9. Wiz Code-to-Cloud メタデータ（S07で使用）
# -----------------------------------------------------------------------------

# ソースリポジトリURL
SOURCE_REPO_URL=https://github.com/${GITHUB_REPOSITORY}

# Dockerイメージラベル（Code-to-Cloud紐付け用）
DOCKER_LABEL_REPO=com.wiz.source.repo=${GITHUB_REPOSITORY}
DOCKER_LABEL_COMMIT=com.wiz.source.commit=${GITHUB_SHA}
DOCKER_LABEL_BRANCH=com.wiz.source.branch=${GITHUB_REF_NAME}


# -----------------------------------------------------------------------------
# 10. S3バケット設定（S11: AWS Inspector比較で使用）
# -----------------------------------------------------------------------------

# AWS InspectorのSBOMエクスポート先S3バケット
INSPECTOR_SBOM_BUCKET=wiz-verification-sbom
INSPECTOR_SBOM_PREFIX=inspector/


# -----------------------------------------------------------------------------
# 注意事項
# -----------------------------------------------------------------------------
# ⚠️  このファイルには機密情報（AWS認証情報含む）が含まれます
# ⚠️  .gitignoreに .env.phase2 を追加してコミット防止
# ⚠️  実際の認証情報は絶対にGitHubにプッシュしないでください
# ⚠️  検証終了後はAWSリソースを必ずクリーンアップしてください
# ⚠️  検証終了後は認証情報をローテーションすることを推奨
#
# ✅  環境変数検証スクリプト:
#     Bash: ./scripts/validate-env.sh phase2
#     PowerShell: .\scripts\validate-env.ps1 phase2
#
# ✅  AWS環境デプロイ:
#     cd taskflow-app/terraform/environments/dev
#     terraform init
#     terraform plan
#     terraform apply
#
# ✅  AWS環境クリーンアップ:
#     cd taskflow-app/terraform/environments/dev
#     terraform destroy
# =============================================================================
